<!DOCTYPE HTML>
<html>
<body>
<h2>Introduction:</h2><p> In this report, I will be focusing on a web application created by Hamid Mansour.  This application’s purpose is to employ the use of the Node.js platform along with MongoDB to create a database that stores game highscore data, and a GUI that displays some of the information in that database.  The reason for this investigation is that, while the application performs well, no substantial measures were taken to ensure the security of the application. Therefore, I will be providing an analysis of certain security flaws that the application contains, and will be giving recommendations as to how best to combat such problems.</p>

<h2>Methodology:</h2><p> For my analysis, while I did not employ any additional software (other than my browser application, Google Chrome and its Developer Tools), I took a look at the structure as a whole and then separated it into distinct pieces.  This allowed me to realize that while each directory in the web application has different code, the interaction between the given parts is the crux of the security problems that might arise. Additionally, I spent time fooling around with the web application to try and have it perform unusually under certain conditions.  This tinkering proved extremely helpful to my diagnosis of the problems.</p>

<h2>Abstract of Findings:</h2><p> In this web application, there are major flaws in security that could potentially prove to be disastrous in the hands of a malicious user.  For one, there is a persistent Cross-Site scripting vulnerability where a user can inject their own code into the database and have it run every single time the user accesses that database item.  Additionally, there is a broken authentication and session management problem, as the mongolab database is not protected with any authentication whatsoever.  Finally, this web app enables Cross-Origin-Resource-Sharing for all domains, which means that any domain can manipulate the database. This is extremely unsafe because it gives potentially dangerous domains full access to the inner workings of the web application, which in turn can lead to more Cross-Site Scripting. However, this app is by no means unsafe forever, and with a series of additions, can be a safe application for users. </p>

<h3>Submit.JSON Security Vulnerability – Cross-Site Scripting </h3><p>
Location: submit.json
Severity of Issue: Very High.  This issue is extremely problematic to the security of the application because it allows anyone to place information into the database.  While this initially does not seem to be problematic, the index page will always access all info in the database when it prints it out, and thus this vulnerability can turn into a persistent Cross-Side scripting attack, which would be triggered every single time someone tried to access the index page.  I noticed this vulnerability because I was aware that user input is always dangerous and I saw that there was no proper input sanitizing within the submit page.  This page is extremely vulnerable to a simple script command, and this lapse in security could be extremely deleterious to the users of the web application.  Because this problem arises when tags are put into use, one way that a developer could fix the problem would be to sanitize the queries that come in through submit.json to make sure that there are no ‘&gt;’ characters.  If there are no ‘&gt;’ characters, tags cannot be completed and thus scripts cannot be inserted, and the web application would be that much safer.</p>

<h3>Cross-Origin Resource Sharing Vulnerability – Cross-Site Scripting</h3><p>
Location: Entire Application
Severity of Issue: Very High.  While this feature of the web application is not a direct vulnerability in and of itself, it is the key to an attacker from another domain to access this domains functions and manipulate them.  It appears that the actual implementation is performed incorrectly, so this is not currently a threat, but this report assumes that the developer will fix his malfunctioning code and thus, the CORS will be enabled. I found this problem because I was told to always be extremely wary of resource sharing with domains that can’t be trusted, and this is a glaring example of that.  Because the developer includes “res.header("Access-Control-Allow-Origin", "*")” in his code, instead of granting only specific websites the ability to access the resources of this web application, the “*” guarantees that any and all domains have full access to the resources.  Because of this Cross-Origin freedom, malicious users can access the submit.json page and break the application in the manner that I mentioned above.  However, this problem has an extremely simple fix.  If the developer specifies which domains have access to its resources as opposed to the everything-goes “*” character, then only certain domains will have access to this web application and it eliminates an immense slew of possible attackers.</p>

<h3>MongoLab Database Authentication Vulnerability – Broken Authentication and Session Management</h3><p>
Location: submit.json
Severity of Issue: Very High. This was one of the overlying problems with this web application, but it was most noticeable in the context of the database.  I found this vulnerability after reviewing the most common security flaws and realizing that none of the resources (including the database) are correctly protected with authentication.  Therefore, a rogue user can access the database through the submit.json POST method without any confirmation that they actually authorized to do so.  This can lead to a series of terrible things, including the addition of poor input into the database.  To be sure that the database will be clean of this input, there must be some sort of an authentication prior to inserting an item into the collection. Therefore, a simple username/password prompt could be used to prevent random users from accessing the database and immediately this problem is diminished considerably.
</p>
<h2>Conclusion</h2>
<p>After examining the facets of this web application, it is clear that there are many problems that could very easily be exploited by a mischievous user.  The common themes that revolve around 2 security flaws: user input validation and resource sharing issues.  However, my code review was not comprehensive, and if the developer was still concerned about the security of his application, investing in such products as IBM's AppScan would be wise to find out of other security flaws.  With this knowledge, securing this website does not seem all that daunting, and with the suggestions that I recommended for each of the three errors I spoke of, this application can become a safe space for users.
</body>
</html>